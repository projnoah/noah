{"version":3,"names":[],"mappings":"","sources":["profile-users.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\n$(function () {\n    var $input, $label, $form;\n    var $image = $('.avatar-crop img');\n    var $resizeButton = $('button#resize-button');\n\n    $('.input-file').each(function () {\n        $input = $(this), $label = $input.next('label');\n\n        $label.on('click', function () {\n            $($input).click();\n        });\n\n        $input.on('change', uploadFile);\n\n        // Firefox bug fix\n        $input.on('focus', function () {\n            $input.addClass('has-focus');\n        }).on('blur', function () {\n            $input.removeClass('has-focus');\n        });\n    });\n\n    $($resizeButton).on('click', function () {\n        var $data = $($image).cropper('getData'),\n            $resizeForm = $(\"form#resize-avatar\");\n\n        $.post({\n            url: $($resizeForm).attr('action'),\n            data: $data,\n            success: function success(jsonData) {\n                if (jsonData.status != 'error') {\n                    Admin.User.avatarUrl = jsonData.avatarUrl;\n                    toastr.success('<h4>' + jsonData.message + '</h4>');\n                    $($resizeButton).fadeOut();\n                    $image.cropper('destroy');\n                } else {\n                    toastr.error('<h4>' + jsonData.message + '</h4>');\n                }\n            },\n            error: function error(er) {\n                toastr.error('<h4>' + er.responseText + '</h4>');\n            },\n            complete: function complete() {\n                setTimeout(function () {\n                    var sel = '#' + $($form).attr('id');\n                    $.pjax.reload(sel);\n                }, 100);\n            }\n        });\n    });\n\n    function uploadFile(e) {\n        var fileName = e.target.value.split('\\\\').pop();\n\n        if (fileName) $label.find('span').html(fileName);\n\n        $form = $form ? $form : $($input).parents(\"form\")[0];\n        $($form).addClass('loading');\n        $($($label).find(\"figure\")[0]).toggleClass('icon-cloud-upload fa fa-spin fa-spinner');\n\n        $.ajaxFileUpload({\n            url: $form.action,\n            dataType: 'json',\n            fileElementId: 'avatar-file',\n            success: function success(d) {\n                $($image).attr('src', d.url);\n                $($image).cropper({\n                    aspectRatio: 1,\n                    rotatable: false,\n                    scalable: false,\n                    zoomable: false\n                });\n                $($resizeButton).fadeIn();\n            },\n            error: function error(er) {},\n            complete: function complete() {\n                $($form).removeClass('loading');\n                $($($label).find(\"figure\")[0]).toggleClass('icon-cloud-upload fa fa-spin fa-spinner');\n            }\n        });\n    }\n});\n\n},{}]},{},[1]);\n"],"file":"profile-users.js","sourceRoot":"/source/"}